<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Excel is Ready</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-5 text-center">
    <h2 class="mb-3">Your Excel file is ready ✅</h2>
    <p class="lead">
        Click the button below to download it. You’ll be taken back to the upload page automatically.
    </p>

    <button id="downloadBtn" class="btn btn-success btn-lg">
        Download &amp; Go to Upload Page
    </button>

    <p class="mt-3">
        If the download doesn’t start, you can
        <a href="{{ download_url }}">click here</a>
        to download manually.
    </p>
</div>

<script>
document.getElementById("downloadBtn").addEventListener("click", function () {
    // Trigger download in a hidden iframe so we can still redirect
    const iframe = document.createElement("iframe");
    iframe.style.display = "none";
    iframe.src = "{{ download_url }}";
    document.body.appendChild(iframe);

    // Redirect shortly after
    setTimeout(function () {
        window.location.href = "{{ url_for('upload_files') }}";
    }, 1500);
});
</script>
</body>
</html>
